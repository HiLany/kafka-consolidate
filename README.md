kafka's apis and transaction  consolidate.